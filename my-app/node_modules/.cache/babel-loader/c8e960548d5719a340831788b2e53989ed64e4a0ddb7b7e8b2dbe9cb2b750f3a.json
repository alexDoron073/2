{"ast":null,"code":"import{useCallback,useEffect,useState}from'react';import'./App.css';import ChatHeader from'./components/ChatHeader';import MessageForm from'./components/MessageForm';import MessageList from'./components/MessageList';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL='/api/messages';function App(){const[messages,setMessages]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[username,setUsername]=useState('');const[text,setText]=useState('');const[pending,setPending]=useState(false);const fetchMessages=useCallback(async()=>{try{setError('');const response=await fetch(API_URL);if(!response.ok){throw new Error('Не удалось загрузить сообщения');}const data=await response.json();setMessages(data);}catch(err){setError(err.message);}finally{setLoading(false);}},[]);useEffect(()=>{fetchMessages();const interval=setInterval(fetchMessages,5000);return()=>clearInterval(interval);},[fetchMessages]);const handleSubmit=async event=>{event.preventDefault();if(!username.trim()||!text.trim())return;setPending(true);try{const response=await fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:username.trim(),text:text.trim()})});if(!response.ok){throw new Error('Не удалось отправить сообщение');}await fetchMessages();setText('');}catch(err){setError(err.message);}finally{setPending(false);}};const handleDelete=async id=>{try{const response=await fetch(\"\".concat(API_URL,\"/\").concat(id),{method:'DELETE'});if(!response.ok){throw new Error('Удаление не удалось');}setMessages(prev=>prev.filter(message=>message.id!==id));}catch(err){setError(err.message);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"chat-app\",children:[/*#__PURE__*/_jsx(ChatHeader,{totalMessages:messages.length}),/*#__PURE__*/_jsx(\"main\",{className:\"chat-body\",children:/*#__PURE__*/_jsx(MessageList,{messages:messages,loading:loading,error:error,onDelete:handleDelete})}),/*#__PURE__*/_jsx(MessageForm,{username:username,text:text,onUsernameChange:setUsername,onTextChange:setText,onSubmit:handleSubmit,pending:pending})]});}export default App;","map":{"version":3,"names":["useCallback","useEffect","useState","ChatHeader","MessageForm","MessageList","jsx","_jsx","jsxs","_jsxs","API_URL","App","messages","setMessages","loading","setLoading","error","setError","username","setUsername","text","setText","pending","setPending","fetchMessages","response","fetch","ok","Error","data","json","err","message","interval","setInterval","clearInterval","handleSubmit","event","preventDefault","trim","method","headers","body","JSON","stringify","handleDelete","id","concat","prev","filter","className","children","totalMessages","length","onDelete","onUsernameChange","onTextChange","onSubmit"],"sources":["C:/Users/doron/Desktop/zzz/node/2/my-app/src/App.js"],"sourcesContent":["import { useCallback, useEffect, useState } from 'react';\nimport './App.css';\nimport ChatHeader from './components/ChatHeader';\nimport MessageForm from './components/MessageForm';\nimport MessageList from './components/MessageList';\n\nconst API_URL = '/api/messages';\n\nfunction App() {\n  const [messages, setMessages] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [username, setUsername] = useState('');\n  const [text, setText] = useState('');\n  const [pending, setPending] = useState(false);\n\n  const fetchMessages = useCallback(async () => {\n    try {\n      setError('');\n      const response = await fetch(API_URL);\n      if (!response.ok) {\n        throw new Error('Не удалось загрузить сообщения');\n      }\n      const data = await response.json();\n      setMessages(data);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchMessages();\n    const interval = setInterval(fetchMessages, 5000);\n    return () => clearInterval(interval);\n  }, [fetchMessages]);\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    if (!username.trim() || !text.trim()) return;\n    setPending(true);\n    try {\n      const response = await fetch(API_URL, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          username: username.trim(),\n          text: text.trim(),\n        }),\n      });\n      if (!response.ok) {\n        throw new Error('Не удалось отправить сообщение');\n      }\n      await fetchMessages();\n      setText('');\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setPending(false);\n    }\n  };\n\n  const handleDelete = async (id) => {\n    try {\n      const response = await fetch(`${API_URL}/${id}`, { method: 'DELETE' });\n      if (!response.ok) {\n        throw new Error('Удаление не удалось');\n      }\n      setMessages((prev) => prev.filter((message) => message.id !== id));\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n\n  return (\n    <div className=\"chat-app\">\n      <ChatHeader totalMessages={messages.length} />\n      <main className=\"chat-body\">\n        <MessageList\n          messages={messages}\n          loading={loading}\n          error={error}\n          onDelete={handleDelete}\n        />\n      </main>\n      <MessageForm\n        username={username}\n        text={text}\n        onUsernameChange={setUsername}\n        onTextChange={setText}\n        onSubmit={handleSubmit}\n        pending={pending}\n      />\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}